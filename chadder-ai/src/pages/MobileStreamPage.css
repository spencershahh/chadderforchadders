/* Mobile Stream Page - Complete Redesign */

/* Base mobile layout - Force override any inline styles */
.stream-page.mobile-mode {
  display: flex !important;
  flex-direction: column !important;
  height: 100% !important;
  min-height: 100% !important;
  width: 100% !important;
  overflow: hidden !important;
  background-color: #0e0e10 !important;
  position: relative !important;
}

/* Mobile stream layout - Use height: 100% instead of vh to avoid browser toolbar issues */
.mobile-stream-layout {
  display: flex !important;
  flex-direction: column !important;
  height: 100% !important;
  width: 100% !important;
  overflow: hidden !important;
  position: relative !important;
  padding: env(safe-area-inset-top, 0) env(safe-area-inset-right, 0) 
          env(safe-area-inset-bottom, 0) env(safe-area-inset-left, 0) !important; /* Full iOS safe area */
}

/* Video container - use aspect ratio approach instead of fixed heights */
.mobile-video-container {
  width: 100% !important;
  position: relative !important;
  background-color: #000 !important;
  z-index: 5 !important;
  aspect-ratio: 16/9 !important;
  max-height: 40vh !important;
  overflow: hidden !important;
}

/* Video container iframe - Force override any inline styles */
.mobile-video-container iframe,
#mobile-twitch-embed iframe {
  width: 100% !important;
  height: 100% !important;
  border: none !important;
  position: relative !important;
  z-index: 1 !important;
  min-height: unset !important; /* Override inline minHeight */
  margin: 0 !important;
  padding: 0 !important;
}

/* Important: Fix to ensure video controls are clickable */
.mobile-video-container::before {
  content: "";
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  z-index: -1;
}

/* Chat header */
.mobile-chat-header {
  display: flex !important;
  justify-content: space-between !important;
  align-items: center !important;
  padding: 10px 16px !important;
  background-color: #18181b !important;
  border-bottom: 1px solid rgba(255, 255, 255, 0.1) !important;
  z-index: 10 !important;
  height: auto !important;
  min-height: 40px !important;
}

/* Chat container - use flex approach instead of fixed vh */
.mobile-chat-container {
  flex: 1 !important;
  width: 100% !important;
  position: relative !important;
  background-color: #18181b !important;
  overflow: hidden !important;
  display: flex !important;
  flex-direction: column !important;
  margin-bottom: 60px !important; /* Make room for bottom bar */
}

/* Chat messages */
.mobile-chat-messages {
  width: 100% !important;
  flex: 1 !important;
  overflow-y: auto !important;
  position: relative !important;
  z-index: 15 !important;
  padding-top: 0 !important; /* Remove padding, handled inside the iframe */
  -webkit-overflow-scrolling: touch !important; /* Smooth scrolling on iOS */
  height: 100% !important;
}

/* Handle Twitch's cookie banner by pushing content down */
.mobile-chat-messages::before {
  content: "";
  display: block;
  height: 0;
  width: 100%;
}

/* Twitch chat iframe */
#mobile-twitch-chat {
  width: 100% !important;
  height: 100% !important;
  position: relative !important;
  z-index: 2 !important;
  overflow: hidden !important;
}

/* Force override iframe styling */
#mobile-twitch-chat iframe,
.chat-iframe {
  width: 100% !important;
  height: 100% !important;
  border: none !important;
  overflow: visible !important;
  min-height: unset !important;
  padding: 0 !important;
  margin: 0 !important;
}

/* Fixing Twitch embedded chat display */
#mobile-twitch-chat iframe body {
  padding-top: 0 !important;
  margin-top: 0 !important;
}

/* Fix for Twitch's chat input */
#mobile-twitch-chat::after {
  content: "";
  display: block;
  height: 50px;
  width: 100%;
}

/* Prevent any elements from blocking chat input */
#mobile-twitch-chat iframe textarea,
#mobile-twitch-chat iframe input,
#mobile-twitch-chat iframe [contenteditable="true"] {
  z-index: 200 !important;
  pointer-events: auto !important;
}

/* Hide cookie banner (attempt) */
#mobile-twitch-chat iframe div[data-a-target="consent-banner"],
.chat-iframe div[data-a-target="consent-banner"] {
  display: none !important;
  height: 0 !important;
  overflow: hidden !important;
}

/* Supporters section - hidden by default on mobile */
.mobile-supporters {
  display: none !important;
}

/* Bottom bar with stats and vote button - Fixed at bottom */
.mobile-bottom-bar {
  width: 100% !important;
  height: 60px !important;
  background-color: #0e0e10 !important;
  border-top: 1px solid rgba(255, 255, 255, 0.1) !important;
  position: fixed !important;
  bottom: 0 !important;
  left: 0 !important;
  right: 0 !important;
  display: flex !important;
  z-index: 50 !important;
  padding-bottom: env(safe-area-inset-bottom, 0) !important;
}

/* Stats information */
.mobile-stats-row {
  flex: 1 !important;
  display: flex !important;
  justify-content: space-between !important;
  align-items: center !important;
  padding: 0 10px !important;
  background-color: transparent !important;
  height: 100% !important;
  transition: all 0.3s ease !important;
}

.mobile-stats-row.collapsed {
  transform: translateY(100%) !important;
}

/* Stats toggle button - enlarged for better touch target */
.stats-toggle-button {
  position: absolute !important;
  top: -30px !important;
  left: 50% !important;
  transform: translateX(-50%) !important;
  background-color: rgba(25, 22, 36, 0.95) !important;
  border: 1px solid rgba(255, 255, 255, 0.1) !important;
  border-bottom: none !important;
  border-radius: 8px 8px 0 0 !important;
  color: white !important;
  padding: 8px 16px !important;
  font-size: 14px !important;
  cursor: pointer !important;
  z-index: 51 !important;
  min-height: 44px !important; /* Apple's recommended min touch target */
  min-width: 80px !important;
  display: flex !important;
  align-items: center !important;
  justify-content: center !important;
}

/* Time and Prize display */
.mobile-time-display,
.mobile-prize-display {
  display: flex !important;
  flex-direction: column !important;
  justify-content: center !important;
  padding: 0 5px !important;
}

.mobile-time-display {
  text-align: left !important;
}

.mobile-prize-display {
  text-align: right !important;
}

.mobile-time-label,
.mobile-prize-label {
  font-size: 11px !important;
  color: rgba(255, 255, 255, 0.7) !important;
  margin-bottom: 4px !important;
}

.mobile-time-value {
  font-size: 16px !important;
  font-weight: 600 !important;
  color: #43b581 !important;
  font-family: monospace !important;
  line-height: 1.2 !important;
}

.mobile-prize-value {
  font-size: 16px !important;
  font-weight: 600 !important;
  color: #f7b955 !important;
  line-height: 1.2 !important;
}

/* Vote button - enlarged for better touch target */
.vote-button {
  min-width: 100px !important;
  min-height: 44px !important; /* Apple's recommended min touch target */
  margin: 7px 10px !important;
  background-color: #9147ff !important;
  color: white !important;
  border: none !important;
  border-radius: 8px !important;
  font-weight: 600 !important;
  font-size: 14px !important;
  text-transform: uppercase !important;
  letter-spacing: 1px !important;
  align-self: center !important;
  z-index: 52 !important;
  cursor: pointer !important;
  padding: 10px 16px !important;
  -webkit-tap-highlight-color: rgba(0,0,0,0) !important; /* Remove tap highlight */
}

/* Fix offline message display */
.mobile-video-container .offline-message,
.mobile-video-container div[data-a-target="player-overlay-content"] {
  display: flex !important;
  flex-direction: column !important;
  align-items: center !important;
  justify-content: center !important;
  text-align: center !important;
  padding: 20px !important;
  height: 100% !important;
  width: 100% !important;
  box-sizing: border-box !important;
}

/* Improve offline text visibility */
.mobile-video-container div[data-a-target="player-overlay-text"] {
  font-size: 16px !important;
  color: white !important;
  font-weight: bold !important;
  margin-bottom: 10px !important;
}

/* Adding height for Twitch's cookie banner */
.chat-iframe {
  margin-bottom: 0 !important;
  padding-top: 0 !important; /* Remove extra padding */
}

/* Full-width vote button at bottom - can be toggled with a class */
.vote-button-fullwidth {
  position: fixed !important;
  bottom: 0 !important;
  left: 0 !important;
  right: 0 !important;
  width: 100% !important;
  margin: 0 !important;
  height: 50px !important;
  border-radius: 0 !important;
  z-index: 100 !important;
}

/* Media queries for modern devices - iPhone Pro Max (428px width) */
@media screen and (min-width: 390px) and (max-width: 428px) {
  .mobile-time-value,
  .mobile-prize-value {
    font-size: 16px !important;
  }
  
  .vote-button {
    min-width: 110px !important;
  }
}

/* Media queries for iPhone Pro & similar (390px width) */
@media screen and (min-width: 375px) and (max-width: 389px) {
  .mobile-time-value,
  .mobile-prize-value {
    font-size: 15px !important;
  }
  
  .vote-button {
    min-width: 100px !important;
  }
}

/* Media queries for iPhone Mini & similar (< 375px width) */
@media screen and (max-width: 374px) {
  .vote-button {
    min-width: 90px !important;
    font-size: 12px !important;
    padding: 8px 12px !important;
  }
  
  .mobile-time-value,
  .mobile-prize-value {
    font-size: 14px !important;
  }
  
  .mobile-time-label,
  .mobile-prize-label {
    font-size: 10px !important;
  }
}

/* Adjust for landscape orientation */
@media screen and (orientation: landscape) {
  .mobile-video-container {
    aspect-ratio: 16/9 !important;
    max-height: 50vh !important;
  }
  
  .mobile-chat-container {
    max-height: 50vh !important;
  }
}

/* Fix for Twitch vote modals and popups */
.vote-modal-overlay,
.vote-modal {
  z-index: 1000 !important; /* Ensure it's above everything */
}

/* Fix for notched iPhones and iOS devices */
@supports (padding: env(safe-area-inset-bottom)) {
  .mobile-bottom-bar {
    padding-bottom: env(safe-area-inset-bottom, 0) !important;
    height: calc(60px + env(safe-area-inset-bottom, 0)) !important;
  }
  
  .mobile-chat-container {
    padding-bottom: calc(60px + env(safe-area-inset-bottom, 0)) !important;
  }
  
  .vote-button-fullwidth {
    padding-bottom: env(safe-area-inset-bottom, 0) !important;
    height: calc(50px + env(safe-area-inset-bottom, 0)) !important;
  }
  
  /* Handle top notch area */
  .mobile-video-container {
    padding-top: env(safe-area-inset-top, 0) !important;
  }
}

/* Fix for dynamic toolbar heights on mobile browsers */
@media screen and (max-height: 700px) {
  .mobile-chat-messages {
    padding-top: 0 !important;
  }
}

/* Handle iPhone 14/15/16 Pro specific dimensions */
@media screen and (min-width: 390px) and (max-width: 393px) and (min-height: 844px) and (max-height: 852px) {
  .mobile-video-container {
    max-height: 35vh !important;
  }
}

/* Adding touch momentum scrolling for all scrollable areas */
.mobile-chat-messages,
#mobile-twitch-chat,
.mobile-stream-layout {
  -webkit-overflow-scrolling: touch !important;
  overflow-scrolling: touch !important;
} 